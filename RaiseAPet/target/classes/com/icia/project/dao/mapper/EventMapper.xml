<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="event">
	<!--이벤트 -->
	<!--EventList-->
	<select id="eventList" resultType="event" parameterType="event">
		SELECT * FROM EVENT
	</select>
	
	<!-- EventHit -->
	<update id="eventHit" parameterType="event">
		UPDATE EVENT
		SET EVENTHIT = #{eventHit} + 1
		WHERE EVENTNUM = #{eventNum}	
	</update>
	
	<!-- EventView  -->
	<select id="eventView" resultType="event" parameterType="event">
		SELECT * FROM EVENT WHERE EVENTNUM = #{eventNum}	
	</select>
	
	<!-- 쿠폰 -->
	
	<!-- CouponPayment -->
	<insert id="eventCouponPayment" parameterType="map">
		INSERT INTO MEMBER_COUPON VALUES (#{userId},#{eventCouponCode})
	</insert>
	
	<!-- 포인트 -->
	<!-- pointPayment -->
	<update id="eventPointPayment" parameterType="member">
		UPDATE MEMBERS
		SET  USERPOINT =  USERPOINT + 100
		WHERE USERID = #{userId}
	</update>	
	
	
	
	<!--댓글  -->
	
	<!-- EventCommentList -->
	<select id="eventCommentList" resultType="eventComment" parameterType="int">
		SELECT * FROM EVENT_COMMENT WHERE COMMENTEVENTNUM = #{commentEventNum} ORDER BY COMMENTNUM DESC
	</select>
		
	<!-- EventCommnetWrite -->	
	<insert id="eventCommentWrite" parameterType="eventComment">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
		INSERT INTO EVENT_COMMENT VALUES (#{commentEventNum},EVENT_COMMENT_SEQ.nextval,#{commentContents},#{commentUserId},#{commentImage},0,SYSDATE)
	</insert>	
								
	<!-- EventCommentLikeDelete -->
	<delete id="EventCommentLikeDelete">
		DELETE FROM EVENT_COMMENT_LIKE WHERE LIKECOMMENTNUM = #{commentNum} AND LIKECOMMENTEVENTNUM = #{commentEventNum}
	</delete>
	
	<!-- EventCommentDelete -->
	<delete id="eventCommentDelete" parameterType="eventComment">
		DELETE FROM EVENT_COMMENT WHERE COMMENTNUM = #{commentNum} AND COMMENTEVENTNUM = #{commentEventNum}
	</delete>
	
	<!-- EventCommentModifyProcess -->
	<update id="eventCommentModifyProcess" parameterType="eventComment">
		UPDATE EVENT_COMMENT
		SET COMMENTCONTENTS = #{commentContents}
		WHERE COMMENTNUM = #{commentNum} AND COMMENTEVENTNUM = #{commentEventNum}
	</update>
	
	<!--EventCommentLikeCheck  -->
	<select id="eventCommentLikeCheck" resultType="String" parameterType="eventComment">
		SELECT LIKEUSERID 
		FROM  EVENT_COMMENT_LIKE 
		WHERE LIKEUSERID=#{commentUserId} AND LIKECOMMENTNUM = #{commentNum} AND LIKECOMMENTEVENTNUM = #{commentEventNum}
	</select>
	
	<!--EventCommentLikeAdd  -->
	<insert id="eventCommentLikeAdd" parameterType="eventComment">
		INSERT INTO EVENT_COMMENT_LIKE VALUES(#{commentEventNum},#{commentNum},#{commentUserId})
	</insert>
	
	<!--EventCommentLike  -->
 	<update id="eventCommentLike" parameterType="eventComment">
		UPDATE EVENT_COMMENT
		SET COMMENTLIKE = COMMENTLIKE + 1
		WHERE COMMENTNUM = #{commentNum} AND COMMENTEVENTNUM = #{commentEventNum}
	</update>
	
	<!--EventCommentUnLike  -->
	<update id="eventCommentUnLike" parameterType="eventComment">
		UPDATE EVENT_COMMENT
		SET COMMENTLIKE = COMMENTLIKE - 1
		WHERE COMMENTNUM = #{commentNum} AND COMMENTEVENTNUM = #{commentEventNum}
	</update>
	
	<!--EventCommentLikeUserIdDelete -->
	<delete id="EventCommentLikeUserIdDelete" parameterType="eventComment">
		DELETE
		FROM EVENT_COMMENT_LIKE 
		WHERE LIKECOMMENTNUM = #{commentNum} AND LIKECOMMENTEVENTNUM = #{commentEventNum} AND LIKEUSERID = #{commentUserId}
	</delete>
	
</mapper>